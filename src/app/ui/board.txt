'use client';

import React, { useState } from 'react';
import Categories from './categories'; // Import Categories

type FieldStatus = 0 | 1 | 2;

const Board: React.FC = () => {
    const categories = ['read', 'workout', 'walk'];

    // State to track the active category
    const [selectedCategory, setSelectedCategory] = useState<string>('read');

    // State to track fieldStatus for each category
    const [categoryFieldStatus, setCategoryFieldStatus] = useState<Record<string, FieldStatus[]>>({
        read: Array(28).fill(0),
        workout: Array(28).fill(0),
        walk: Array(28).fill(0),
    });

    const handleCategoryClick = (category: string) => {
        setSelectedCategory(category);
    };

    const handleSingleClick = (index: number): void => {
        const updatedStatus = [...categoryFieldStatus[selectedCategory]];
        updatedStatus[index] = 1; // Set green
        setCategoryFieldStatus({ ...categoryFieldStatus, [selectedCategory]: updatedStatus });
    };

    const handleDoubleClick = (index: number): void => {
        const updatedStatus = [...categoryFieldStatus[selectedCategory]];
        updatedStatus[index] = 2; // Set red
        setCategoryFieldStatus({ ...categoryFieldStatus, [selectedCategory]: updatedStatus });
    };

    return (
        <div className="flex flex-col items-center gap-4">
            {/* Pass active state and handler to Categories */}
            <Categories
                fieldStatus={categoryFieldStatus}
                selectedCategory={selectedCategory}
                onCategoryClick={handleCategoryClick}
            />

            {/* Board Section */}
            <div className="grid grid-cols-7">
                {categoryFieldStatus[selectedCategory].map((status, index) => (
                    <div
                        key={index}
                        onClick={() => handleSingleClick(index)}
                        onDoubleClick={() => handleDoubleClick(index)}
                        className={`border text-xl flex justify-center items-center select-none
                        ${status === 1
                            ? 'bg-green-background text-green-txt border-green-background'
                            : status === 2
                            ? 'bg-red-background text-red-txt border-red-background'
                            : 'border-default-color text-txt-color'}`}
                        style={{ width: '134px', height: '134px' }}
                    >
                        {index + 1}
                    </div>
                ))}
            </div>
        </div>
    );
};

export default Board;
